<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Public Name Masquerade for TLS Encrypted Client Hello</title>
<meta content="Martin Thomson" name="author">
<meta content="Marwan Fayed" name="author">
<meta content="
       An alternative method
for authenticating Encrypted Client Hello (ECH)
retry configurations is described.
This method enables the use of multiple
public names for the same server anonymity set. 
    " name="description">
<meta content="xml2rfc 3.28.0" name="generator">
<meta content="next generation" name="keyword">
<meta content="unicorn" name="keyword">
<meta content="sparkling distributed ledger" name="keyword">
<meta content="draft-thomson-tls-ech-pnmasq-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.0
    Python 3.12.9
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.5
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-thomson-tls-ech-pnmasq.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Public Name Masquerade</td>
<td class="right">March 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Thomson &amp; Fayed</td>
<td class="center">Expires 4 September 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Transport Layer Security</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-thomson-tls-ech-pnmasq-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-03-03" class="published">3 March 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-09-04">4 September 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Thomson</div>
<div class="org">Mozilla</div>
</div>
<div class="author">
      <div class="author-name">M. Fayed</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Public Name Masquerade for TLS Encrypted Client Hello</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">An alternative method
for authenticating Encrypted Client Hello (ECH)
retry configurations is described.
This method enables the use of multiple
public names for the same server anonymity set.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://martinthomson.github.io/ech-pnmasq/draft-thomson-tls-ech-pnmasq.html">https://martinthomson.github.io/ech-pnmasq/draft-thomson-tls-ech-pnmasq.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-thomson-tls-ech-pnmasq/">https://datatracker.ietf.org/doc/draft-thomson-tls-ech-pnmasq/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Transport Layer Security Working Group mailing list (<span><a href="mailto:tls@ietf.org">mailto:tls@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tls/">https://mailarchive.ietf.org/arch/browse/tls/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/tls/">https://www.ietf.org/mailman/listinfo/tls/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/martinthomson/ech-pnmasq">https://github.com/martinthomson/ech-pnmasq</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 4 September 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-privacy-in-ech" class="internal xref">Privacy in ECH</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-unique-public-names" class="internal xref">Unique Public Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-limitations" class="internal xref">Limitations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-alternative-authentication-" class="internal xref">Alternative Authentication for Public Names</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-definitions" class="internal xref">Conventions and Definitions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-alternative-retry-authentic" class="internal xref">Alternative Retry Authentication</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-ech-public-name-masquerade-" class="internal xref">ECH Public Name Masquerade Extension</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-retry-configuration-authent" class="internal xref">Retry Configuration Authentication</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-deployment" class="internal xref">Deployment</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-public-name-selection" class="internal xref">Public Name Selection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-one-to-one-name-mappings" class="internal xref">One-to-One Name Mappings</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-candidate-processes-for-nam" class="internal xref">Candidate Processes for Name Selection</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-key-lifetime" class="internal xref">Key Lifetime</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-ech-profiles" class="internal xref">ECH Profiles</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-sample-public-name-generati" class="internal xref">Sample Public Name Generation Method</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="auto internal xref">7.3.1</a>.  <a href="#name-authenticated-encryption" class="internal xref">Authenticated Encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="auto internal xref">7.3.2</a>.  <a href="#name-parameter-selection" class="internal xref">Parameter Selection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3.2.3">
                    <p id="section-toc.1-1.7.2.3.2.3.1"><a href="#section-7.3.3" class="auto internal xref">7.3.3</a>.  <a href="#name-retry-configuration-generat" class="internal xref">Retry Configuration Generation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-sample-authentication-key-g" class="internal xref">Sample Authentication Key Generation Method</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-recovery-of-anonymity-sets" class="internal xref">Recovery of Anonymity Sets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-configuration-availability" class="internal xref">Configuration Availability</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-unique-mapping-to-hidden-na" class="internal xref">Unique Mapping To Hidden Names</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-client-privacy" class="internal xref">Client Privacy</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The TLS Encrypted Client Hello (ECH) <span>[<a href="#ECH" class="cite xref">ECH</a>]</span>
defines a 'retry' fallback mechanism that is used when a client
attempts to use an outdated or incorrect configuration. The retry
requires that the server can authenticate its identity to the
client. This recovery is an essential feature of ECH, but it can
contribute to a reduction in the size of the anonymity set of
server identities.<a href="#section-1-1" class="pilcrow">¶</a></p>
<div id="privacy-in-ech">
<section id="section-1.1">
        <h3 id="name-privacy-in-ech">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-privacy-in-ech" class="section-name selfRef">Privacy in ECH</a>
        </h3>
<p id="section-1.1-1">In a TLS Encrypted Client Hello (ECH) <span>[<a href="#ECH" class="cite xref">ECH</a>]</span>,
the level of privacy is dependent on its deployment. Privacy in
ECH is proportional to the number of possible names that could be
encrypted in the <code>ClientHelloInner</code> relative to the name(s) in
the <code>ClientHelloOuter</code>. This means that privacy is defined by the
'herd' of names, not of users, which contrasts with
longer-standing schemes for secure or private communication such
as VPNs, Tor, and oblivious proxies, to name a few.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Privacy in ECH is conferred by either or both of the
<code>ClientHelloInner</code> and the <code>ClientHelloOuter</code>. For example, 100
names that share the same ECH configuration establish an
anonymity set of 100, irrespective of the number of users, i.e.,
an observer's ability to know the contents of the
ClientHelloInner is neither advantaged nor disadvantaged by the
number of users connecting to the ClientHelloOuter. However, this
setup is dependent on the operator, and confers no additional
privacy to one-server one-name deployments.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Alternatively, an ECH deployment may vary the number of names in
the <code>ClientHelloOuter</code>. If the set size is finite consisting of
public names, then every query for the HTTPS RR may be populated
with any of the names selected at random. In this setup an
adversary must engage in a "Coupon Collector" exercise to identify
all names in the set. Names could also be randomized, which would
force every server to decrypt all connections, including for
names it knows it does not own.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">A natural way to improve privacy maximizes the 'herd' quality by
creating an anonymity set consisting of all names from all
servers---effectively rendering every connection
indistinguishable to an adversary from every other connection.
This would mean sharing a single consistent ECH configuration
(<span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-23#section-4" class="relref">Section 4</a> of [<a href="#ECH" class="cite xref">ECH</a>]</span>)
across all clients or, alternatively, across all providers and
servers.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<p id="section-1.1-5">However, a consistent configuration negates any single server's
ability to authenticate itself on the SNI in the
ClientHelloOuter. Authentication against a public name is needed
so the server can safely invoke a retry mechanism, for example,
when a client attempts to use outdated or incorrect
configuration. This recovery is an essential feature of ECH that
also ensures a server attempts to decrypt only those ECH
connections it expects, for example, so that a server for
example.com does not attempt to decrypt ECH connections for
not-example.com.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<p id="section-1.1-6">The need to authenticate a public name also limits the size of
the anonymity set to the number of names available at the server,
thereby upper-bounding ECH privacy to its server's deployment.<a href="#section-1.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unique-public-names">
<section id="section-1.2">
        <h3 id="name-unique-public-names">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-unique-public-names" class="section-name selfRef">Unique Public Names</a>
        </h3>
<p id="section-1.2-1">This document describes an approach that seeks
to improve privacy by increasing the number of public names.
Rather than having as few public names as possible,
it increases the size of the anonymity set
for public names
by using as many public names as possible.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">In the ideal form of this approach,
a unique public name is used for each client.
In practice,
caching of HTTPS records <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>
will ensure that the same public name
is likely to be used by some number of clients.
A client cannot be sure that a configuration
is not available to others,
unless it is provided directly
through a mechanism like a ECH Retry,
as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-23#section-6.1.6" class="relref">Section 6.1.6</a> of [<a href="#ECH" class="cite xref">ECH</a>]</span>.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">Any reuse of a name will cluster clients
into relatively small anonymity sets.
Any clustering will be based on attributes
that already leak to a passive observer.
This includes
the time,
the network that a client uses,
or the choice of DNS resolver.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">The net effect is that the public name
is either unique (used for a single connection)
or forms a small anonymity set (used for a small number of connections).
Assembling observed connection attempts
into groups that represent the true anonymity set
requires that an adversary obtain mappings for all of the public names
that correspond to the same hidden names.
If public name is a sufficient-strong encryption
of the hidden name,
an adversary either needs to receive that mapping
or they are only able to use inference
(such as website fingerprinting).<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">An increased diversity of public names
leads to a much larger effective anonymity set.
An adversary that is ignorant of mappings
for each public name
effectively observes a single anonymity set
that corresponds to every name that it does not know.
Both the public name and other ECH configuration values,
such as HPKE <span>[<a href="#RFC9180" class="cite xref">RFC9180</a>]</span> parameters,
are obscured.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">The use of multiple public names
can undermine the effectiveness of ECH
if poorly implemented;
<a href="#deployment" class="auto internal xref">Section 6</a> includes a discussion of these considerations.
This approach also cannot hide the use of IP addresses
that correspond to a set of hidden names.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="limitations">
<section id="section-1.3">
        <h3 id="name-limitations">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-limitations" class="section-name selfRef">Limitations</a>
        </h3>
<p id="section-1.3-1">Though diversity in public names
could create a larger anonymity set for hidden names,
that could be partitioned
by information that leaks as part of connection establishment and use.
In particular, server IP addresses are not hidden
and can be used to distinguish services.
Website fingerprinting <span>[<a href="#WFP" class="cite xref">WFP</a>]</span>
might also be used to recover the identity of hidden sites.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">This protection is limited
to those public names for which an adversary
is unable to recover the mapping to the corresponding hidden names.
As mappings could be retained in shared caches
at DNS resolvers,
this creates a significant risk;
see <a href="#unique-mapping" class="auto internal xref">Section 6.2</a> for details.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<p id="section-1.3-3">The use of multiple public names
can undermine the effectiveness of ECH
if incautiously implemented.
<a href="#deployment" class="auto internal xref">Section 6</a> includes a discussion of these considerations.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="alternative-authentication-for-public-names">
<section id="section-1.4">
        <h3 id="name-alternative-authentication-">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-alternative-authentication-" class="section-name selfRef">Alternative Authentication for Public Names</a>
        </h3>
<p id="section-1.4-1">This document defines a new method
for validating the certificate that a server proffers
during an ECH retry.
This enables a retry process that does not
depend on the public key infrastructure
that is used for server authentication,
making it far easier to create new public names.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
<p id="section-1.4-2">These names can even overlap with
parts of the domain name system.
The client determines
whether a server is authorized to provide
an ECH retry configuration
based on the choice of name alone.
This removes any need to rely on anything other than
the public key that is bound to the name.
This obviates any need for revocation checks,<a href="#section-1.4-2" class="pilcrow">¶</a></p>
<p id="section-1.4-3">This change to public name authentication
is the only aspect of this document that requires
client changes.
This document describes a server architecture
that helps demonstrate the feasibility of this approach,
including an analysis of drawbacks; see <a href="#authn" class="auto internal xref">Section 3</a>.<a href="#section-1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions-and-definitions">
<section id="section-2">
      <h2 id="name-conventions-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-definitions" class="section-name selfRef">Conventions and Definitions</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authn">
<section id="section-3">
      <h2 id="name-alternative-retry-authentic">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-alternative-retry-authentic" class="section-name selfRef">Alternative Retry Authentication</a>
      </h2>
<p id="section-3-1">ECH defines a retry process
for when the ECH configuration that a client uses
is rejected by a server.
The server completes the handshake
using the outer (or unprotected) ClientHello.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">By default, the server offers a certificate
that is valid for the outer "server_name" that is used.
The client then authenticates the handshake
using that certificate
and the process by which a client would ordinarily
validate a server identity.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">That ordinary process relies on
the client having previously established
which name it wishes to authenticate.
The name that is used during an ECH retry
comes from the ECH configuration.
The ECH configuration is typically obtained
from the SVCB record <span>[<a href="#SVCB" class="cite xref">SVCB</a>]</span>,
which ECH treats as unauthenticated;
see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-23#section-10.2" class="relref">Section 10.2</a> of [<a href="#ECH" class="cite xref">ECH</a>]</span>.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">The client therefore relies on the ECH configuration
to choose the public name that it authenticates.
This opens the possibility that the ECH configuration
can also specify alternative means of authentication.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">The public name therefore does not need to be valid
according to ordinary client expectations.
The public name exists solely to carry information to the server
about the anonymity set
into which the connection attempt falls.
The public name value could even be encrypted;
see <a href="#deployment" class="auto internal xref">Section 6</a>.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">This document defines an ECH configuration extension,
"public_name_authn",
that specifies an alternative name
and the means by which that alternative name is authenticated.<a href="#section-3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extension">
<section id="section-4">
      <h2 id="name-ech-public-name-masquerade-">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-ech-public-name-masquerade-" class="section-name selfRef">ECH Public Name Masquerade Extension</a>
      </h2>
<p id="section-4-1">An extension is defined for ECH
that includes a randomized name
and information necessary to authenticate
the TLS handshake that
supplies an ECH retry configuration.<a href="#section-4-1" class="pilcrow">¶</a></p>
<span id="name-public_name_authn-extension"></span><div id="fig-pn-auth">
<figure id="figure-1">
        <div class="lang-tls-syntax sourcecode" id="section-4-2.1">
<pre>
struct {
  SignatureScheme scheme;
  opaque spki_hash[32];
} PublicNameAuthentication;
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-public_name_authn-extension" class="selfRef">public_name_authn Extension Structure</a>
        </figcaption></figure>
</div>
<p id="section-4-3">This extension is defined as mandatory,
because a server that uses this approach
relies on clients applying
the alternative authentication method
to validate the public name.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Clients <span class="bcp14">MUST NOT</span> use an ECH configuration
with this extension
unless the connection they establish
includes the indicated signature scheme
in a "signature_algorithms" extension.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">An ECH configuration with this extension
refers to a public name
that the operator of the client-facing server
might not have a valid certificate for;
see <a href="#name-selection" class="auto internal xref">Section 6.1</a>.
Clients that use an ECH configuration with this extension
<span class="bcp14">MUST</span> follow the process for authenticating an ECH retry
described in <a href="#retry-authn" class="auto internal xref">Section 5</a>.<a href="#section-4-5" class="pilcrow">¶</a></p>
<aside id="section-4-6">
        <p id="section-4-6.1">This might be marginally more compatible
if the extension were optional.
In that case, the extension would have to
include the bogus public name as well,
which would be less efficient in the longer term.<a href="#section-4-6.1" class="pilcrow">¶</a></p>
<p id="section-4-6.2">In the short term, this approach is less efficient
as it forces a server that wishes
to support clients that do not support this extension
to provide additional configurations.<a href="#section-4-6.2" class="pilcrow">¶</a></p>
</aside>
</section>
</div>
<div id="retry-authn">
<section id="section-5">
      <h2 id="name-retry-configuration-authent">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-retry-configuration-authent" class="section-name selfRef">Retry Configuration Authentication</a>
      </h2>
<p id="section-5-1">A server that rejects an ECH configuration
can use a certificate or raw public key <span>[<a href="#RAW" class="cite xref">RAW</a>]</span>.
Clients extract the <code>subjectPublicKeyInfo</code>,
either from the certificate or,
for raw public keys,
the Certificate message content.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The resulting <code>subjectPublicKeyInfo</code> structure
is hashed using SHA-256
and compared to the <code>spki_hash</code> value from the
"public_name_authn" extension in the ECH configuration.
If the value matches,
the retry configuration is accepted.
Otherwise, the connection attempt <span class="bcp14">MUST</span> be aborted
and any retry configuration that is provided
is discarded.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">This procedure largely replaces the procedure
in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-23#section-6.1.7" class="relref">Section 6.1.7</a> of [<a href="#ECH" class="cite xref">ECH</a>]</span>.
This does not change the requirement that
the client not
provide a certificate if requested
or regard the connection as authenticated for the origin.<a href="#section-5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deployment">
<section id="section-6">
      <h2 id="name-deployment">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-deployment" class="section-name selfRef">Deployment</a>
      </h2>
<p id="section-6-1">Client-facing server deployments
can use dynamically-generated public names
using techniques similar to those
described in this section.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The use of these techniques
requires careful consideration of the privacy risks.
Two basic outcomes are worth considering:<a href="#section-6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-3.1">
          <p id="section-6-3.1.1">ECH configurations
that are never seen by an adversary.
If this is achievable,
unique public names can be provided to clients,
which greatly improves privacy.
The net effect can be that
only the server IP address leaks information to observers
about the extent of the anonymity set.<a href="#section-6-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-3.2">
          <p id="section-6-3.2.1">ECH configurations are seen by adversaries.
This is a more likely situation,
because the use of DNS for distribution
means that any given ECH configuration
is likely to be served to many clients.<a href="#section-6-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-6-4"><a href="#unique-mapping" class="auto internal xref">Section 6.2</a> discusses how
the choice of public name is important
for maintaining the privacy of hidden names
in the second case.
<a href="#sample" class="auto internal xref">Section 7</a> discusses options
for constructing public names
to minimize the potential risks
that come from adversary access to the ECH configuration.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">This section addresses other deployment considerations.<a href="#section-6-5" class="pilcrow">¶</a></p>
<div id="name-selection">
<section id="section-6.1">
        <h3 id="name-public-name-selection">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-public-name-selection" class="section-name selfRef">Public Name Selection</a>
        </h3>
<p id="section-6.1-1">The public name used in the ECH configuration
does not need to be valid according to any grammar.
Any sequence of octets
up to the limit for public names (255 bytes)
is possible.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">Names that appear to be domain names
are most likely to be widely compatible.
That is, names formed from a sequence LDH labels,
as defined in <span><a href="https://rfc-editor.org/rfc/rfc5890#section-2.3.1" class="relref">Section 2.3.1</a> of [<a href="#IDNA" class="cite xref">IDNA</a>]</span>,
each joined with periods ('.').<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unique-mapping">
<section id="section-6.2">
        <h3 id="name-one-to-one-name-mappings">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-one-to-one-name-mappings" class="section-name selfRef">One-to-One Name Mappings</a>
        </h3>
<p id="section-6.2-1">A simple method for generating public names
is to generate a fresh name
for every ECH configuration.
If every public name is different,
then each public name also corresponds
to a single hidden name.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Use of such a public name
reveals the hidden name
to any entity that knows of the relation.
Using a unique public name for every hidden name
is therely only possible
if the ECH configuration can be kept secret.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">Unique names are incompatible with distribution using DNS,
which involves shared caches at recursive resolvers.
An adversary that is able to obtain
the ECH configuration from a shared DNS cache
would be able to learn the hidden name
that corresponds to the included public name.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">It is therefore important that any given public name
be plausibly associated with multiple hidden names.
This can be achieved by increasing
the size of the anonymity set,
together with the inclusion of information that
diversifies the public name.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sample">
<section id="section-7">
      <h2 id="name-candidate-processes-for-nam">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-candidate-processes-for-nam" class="section-name selfRef">Candidate Processes for Name Selection</a>
      </h2>
<p id="section-7-1">A deployment can generate a secret
and distribute that secret
to all client-facing servers
and all authoritative name servers.
A corresponding short key identifier
might be generated using a counter.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The secret can be split into two parts for use:<a href="#section-7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.1">
          <p id="section-7-3.1.1">A key for enciphering public names.
<a href="#sample-pn-enc" class="auto internal xref">Section 7.3</a> describes a sample process.<a href="#section-7-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-3.2">
          <p id="section-7-3.2.1">A secret for generating authentication keys.
<a href="#sample-authn-key" class="auto internal xref">Section 7.4</a> addresses this process.<a href="#section-7-3.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-4">These secrets need to be distributed
to all authoritative DNS resolvers for hidden names
and all client-facing servers.
There also needs to be a consistent view
across these servers
of how hidden names correspond to ECH profiles
(a concept that this document defines in <a href="#profiles" class="auto internal xref">Section 7.2</a>).<a href="#section-7-4" class="pilcrow">¶</a></p>
<div id="key-lifetime">
<section id="section-7.1">
        <h3 id="name-key-lifetime">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-key-lifetime" class="section-name selfRef">Key Lifetime</a>
        </h3>
<p id="section-7.1-1">If public names are -- in effect -- encrypted,
the lifetime of any keys that are used needs
to exceed the lifetime of ECH keys.
Otherwise, servers will be unable to recover
when clients use old ECH configurations.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">The keys used to protect public names only exist
to protect the extent of the anonymity set.
These keys can be rotated less often
than the keys that are used to protect hidden names.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">Because these keys are only used if a retry is necessary,
it might be possible to ensure that they are only valid
during a periodic transition of ECH keys.
This depends on being able to propagate ECH configurations
to all clients
between the time that these keys are emplaced
and when the ECH keys are changed out.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="profiles">
<section id="section-7.2">
        <h3 id="name-ech-profiles">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-ech-profiles" class="section-name selfRef">ECH Profiles</a>
        </h3>
<p id="section-7.2-1">These procedures assume that a client-facing server
maintains multiple active ECH profiles.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">ECH profile includes
a config identifier,
an HPKE KEM identifier,
a HPKE key pair,
a set of HPKE symmetric cipher suites,
any other extensions,
and (optionally) a public name for use with clients
that do not support this extension.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">Each profile can be allocated an identifier.
This identifier needs to be unique
within the set of profiles that might be concurrently active.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">A client-facing server can limit the number of such profiles
it supports at the one time.
An identifier that is unique
over a larger scope or longer span of time
is inadvisable as that makes it more difficult
to avoid creating unique name mappings (see <a href="#unique-mapping" class="auto internal xref">Section 6.2</a>).<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<p id="section-7.2-5">For a single ECH configuration,
each hidden name needs to be mapped to a single profile.
This ensures that a client-facing server
is able to successfully answer connection attempts
by decrypting the inner ClientHello
or presenting a retry configuration with acceptable authentication.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<p id="section-7.2-6">A hidden name might also be associated
with different profiles
and ECH configurations
according to deployment needs.
In particular,
hidden names might be mapped to different profiles,
as key pairs are rotated
or changes are made to account for different deployment strategies.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<p id="section-7.2-7">With an unmodified ECH deployment,
a client-facing server uses the combination of
the <code>config_id</code> from the outer "encrypted_client_hello" extension
and the public name from the "server_name" extension
to recover a profile.<a href="#section-7.2-7" class="pilcrow">¶</a></p>
<p id="section-7.2-8">In this design,
a client-facing server uses the same information,
except that the true profile identifier is encrypted
and encoded into these two fields.<a href="#section-7.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sample-pn-enc">
<section id="section-7.3">
        <h3 id="name-sample-public-name-generati">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-sample-public-name-generati" class="section-name selfRef">Sample Public Name Generation Method</a>
        </h3>
<p id="section-7.3-1">Public names might be generated by
enciphering the profile identifier.
The encipher values is then encoded into a public name
and, optionally, the configuration identifier field.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">If this were to only contain the profile identifier,
each profile identifier might produce just one public name.
To diversify the set of public names,
additional information is encoded in each name.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">The amount of entropy included for diversification is limited
so that there is a significant chance that
different hidden names produce the same public name.
This is achieved by hashing the inputs used for diversifying names
and taking a limited number of bits from the output.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<p id="section-7.3-4">Suggested inputs that can be used for diversification
include:<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-5.1">
            <p id="section-7.3-5.1.1">The IP address of the DNS client,
or the DNS Client Subnet option,
if present.<a href="#section-7.3-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-5.2">
            <p id="section-7.3-5.2.1">The current time,
rounded to the expected DNS record TTL
or a small integer fraction of that time.
For instance, with a TTL of 30 seconds
the time might be rounded to multiples of 5 seconds.<a href="#section-7.3-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.3-5.3">
            <p id="section-7.3-5.3.1">A small amount of randomness.<a href="#section-7.3-5.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.3-6">In the following pseudocode
'<code>^</code>' is an exclusive OR,
'<code>||</code>' is concatenation,
and '<code>[a..b]</code>' takes a range of bits
from bit '<code>a</code>' (inclusive, default 0) to bit '<code>b</code>' (exclusive).
This code also uses functions for randomness ('<code>random()</code>'),
a collision-resistant hash ('<code>H()</code>'),
a pseudorandom function ('<code>prf()</code>'),
and encoding a byte sequence as a DNS name ('<code>encode_dns()</code>').<a href="#section-7.3-6" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-7.3-7">
<pre>
k1 = prf(secret, "k1" || key_id)
r = random()[..RANDOM_BITS]
diversity = H(client_ip || time || r)[..DIVERSITY_BITS]
k2 = prf(secret, "k2" || diversity)

d = key_id || k1 ^ (diversity || k2 ^ profile_id)

config_id = d[0..8]
public_name = encode_dns(d[8..])
</pre><a href="#section-7.3-7" class="pilcrow">¶</a>
</div>
<aside id="section-7.3-8">
          <p id="section-7.3-8.1">Note that the PRF function only needs
to produce enough bits
to mask the value it obscures using XOR.
Any additional bits can be discarded.<a href="#section-7.3-8.1" class="pilcrow">¶</a></p>
</aside>
<aside id="section-7.3-9">
          <p id="section-7.3-9.1">ISSUE:
This approach reveals to an observer that two
values share a <code>diversity</code> value.<a href="#section-7.3-9.1" class="pilcrow">¶</a></p>
<p id="section-7.3-9.2">Something like format-preserving encryption
might be necessary.
For instance,
a Feistel network might ensure that the entire value
depends on all inputs,
including the profile identifier.<a href="#section-7.3-9.2" class="pilcrow">¶</a></p>
<p id="section-7.3-9.3">The challenge being that
the two layers of protection here,
to protect the profile identifier
and the diversity value,
would each require an application of the network.<a href="#section-7.3-9.3" class="pilcrow">¶</a></p>
</aside>
<div id="authenticated-encryption">
<section id="section-7.3.1">
          <h4 id="name-authenticated-encryption">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-authenticated-encryption" class="section-name selfRef">Authenticated Encryption</a>
          </h4>
<p id="section-7.3.1-1">The use of authenticated encryption <span>[<a href="#AEAD" class="cite xref">AEAD</a>]</span>
is not necessary to achieve privacy goals.
Authentication identifies any name
that is generated without access to the key.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1-2">Avoiding authentication ensures that an adversary
is unable to use side channels
to determine whether any given public name is valid
as all public names receive the same treatment.<a href="#section-7.3.1-2" class="pilcrow">¶</a></p>
<p id="section-7.3.1-3">Authenticated encryption could be used
if a deployment is concerned about
the cost of responding to connection attempts.
This approach could lead to
a significant amount of additional load
on servers due to the need to generate authentication keys
and certificates for every unique public name.<a href="#section-7.3.1-3" class="pilcrow">¶</a></p>
<p id="section-7.3.1-4">Using authenticated encryption only
increases the length of public names;
it does not increase the diversity of names.
Authentication of names therefore
does not affect the potential privacy of public names.<a href="#section-7.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="parameter-selection">
<section id="section-7.3.2">
          <h4 id="name-parameter-selection">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-parameter-selection" class="section-name selfRef">Parameter Selection</a>
          </h4>
<p id="section-7.3.2-1">An adversary that is able to make a request
at about the same time
and from the same client IP or subnet
will learn the mapping from hidden name to public name.
Including more randomness
will reduce the odds that the same public name
is used for a different hidden name.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2-2">The optimal number of random bits that are added
(<code>RANDOM_BITS</code>)
depends on the number of hidden names that
correspond to the same profile identifier,
that is, the size of the anonymity set.
Larger anonymity sets allow for more diversity in names
as there are more public names generated
and a higher chance of collision.<a href="#section-7.3.2-2" class="pilcrow">¶</a></p>
<p id="section-7.3.2-3">For <code>RANDOM_BITS</code>,
generating less than twice the number of bits
as the base 2 logarithm of the anonymity set size
ensures that a collision across the names in the set
is highly likely.
This value might be set significantly less than this limit
to account for the risk that not all hidden names
will be in active use.<a href="#section-7.3.2-3" class="pilcrow">¶</a></p>
<p id="section-7.3.2-4">Combining this information using a hash function,
then taking a limited number of bits
ensures that the number of public names is limited.
This improves the chances that the same public name
is generated for different hidden names.
The number of bits that are retained
(<code>DIVERSITY_BITS</code>)
can exceed the number of random bits,
but only based on the expected number of different
ECH configurations that might be concurrently active
for the active names in the anonymity set.<a href="#section-7.3.2-4" class="pilcrow">¶</a></p>
<p id="section-7.3.2-5">Setting <code>DIVERSITY_BITS</code>
to less than twice the base 2 logarithm
of the total number of ECH configurations
ensures that a collision across the names in the set
is highly likely.<a href="#section-7.3.2-5" class="pilcrow">¶</a></p>
<p id="section-7.3.2-6">The total number of ECH configurations can be determined
most reliably using an empirical measure.
DNS resolvers might count the number of queries
that produce different answers
for hidden names with the same profile
within the TTL of the resource record.<a href="#section-7.3.2-6" class="pilcrow">¶</a></p>
<p id="section-7.3.2-7">Alternatively, the number of possible active ECH configurations
is the anonymity set size
times an estimate of the number of different resolvers.
The alternative approach likely produces a larger estimate,
so it might be adjusted downward
to improve the odds of collisions.<a href="#section-7.3.2-7" class="pilcrow">¶</a></p>
<p id="section-7.3.2-8">In both cases,
a minimum amount random entropy
ensures that even small anonymity set has some diversity.
A minimum of 5 bits ensures that
every hidden name produces public names
from 32 different options.<a href="#section-7.3.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="retry-unique">
<section id="section-7.3.3">
          <h4 id="name-retry-configuration-generat">
<a href="#section-7.3.3" class="section-number selfRef">7.3.3. </a><a href="#name-retry-configuration-generat" class="section-name selfRef">Retry Configuration Generation</a>
          </h4>
<p id="section-7.3.3-1">The process described here can be greatly simplified
for ECH configurations that are
generated by a TLS server
and sent in the "retry_configs" field.<a href="#section-7.3.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3.3-2">Every ECH configuration that is provided
using "retry_configs"
can be unique.
This can be achieved
by setting <code>DIVERSITY_BITS</code> and <code>RANDOM_BITS</code>
to values that are large enough to ensure
that the collision risk is negligible.
The only relevant consideration is
the length of the resulting public name.<a href="#section-7.3.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3.3-3">If a different scheme is used
for generating public names
based on how the ECH configurations are delivered,
it is necessary to distinguish between the forms.
This could use the unprotected key identifier
or just the length of the name
(using a larger value of <code>DIVERSITY_BITS</code>
likely results in a longer name).<a href="#section-7.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sample-authn-key">
<section id="section-7.4">
        <h3 id="name-sample-authentication-key-g">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-sample-authentication-key-g" class="section-name selfRef">Sample Authentication Key Generation Method</a>
        </h3>
<p id="section-7.4-1">An authentication key might be generated as a function of the public name,
and optionally the config_id,
using a pseudorandom function (PRF) that is keyed with a secret.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<div class="lang-pseudocode sourcecode" id="section-7.4-2">
<pre>
authn_secret = prf(secret, public_name)
authn_public_key = pk(authn_secret)
</pre><a href="#section-7.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="security">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">Use of this mechanism inherits
many of the security considerations from <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-23#section-10" class="relref">Section 10</a> of [<a href="#ECH" class="cite xref">ECH</a>]</span>.
Depending on how it is deployed,
it can alter the privacy characteristics,
as it obscures the extent of an anonymity set
presented by a client-facing server;
see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-23#section-10.1" class="relref">Section 10.1</a> of [<a href="#ECH" class="cite xref">ECH</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">This makes it far more difficult
to get a precise enumeration of the names that correspond
to any given anonymity set.<a href="#section-8-2" class="pilcrow">¶</a></p>
<div id="recovery-of-anonymity-sets">
<section id="section-8.1">
        <h3 id="name-recovery-of-anonymity-sets">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-recovery-of-anonymity-sets" class="section-name selfRef">Recovery of Anonymity Sets</a>
        </h3>
<p id="section-8.1-1">This design only permits linking public names
based on what an adversary can observe about the relation
between each hidden name
and all of the public names that are used for that each hidden name.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">Obviously, the reuse of a public name
reveals that the connection attempts
are accessing the same ECH configuration.
The use of ECH still means that uses of those public names
could correspond to different hidden names.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">To provide a comprehensible view of the true anonymity set,
an adversary would need to obtain all public names
that are in use across all hidden names in the set.
If different names are provided in response to every DNS query
from an authoritative resolver,
an adversary would --
at best --
need to query every DNS resolver cache that queries that authoritative.
Diversifying the choice of name based on client IP
or the Client Subnet option
ensures that an adversary needs to make multiple queries
to obtain all of the mappings.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">This makes it far more difficult
to get a precise enumeration of the names that correspond
to any given anonymity set.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="configuration-availability">
<section id="section-8.2">
        <h3 id="name-configuration-availability">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-configuration-availability" class="section-name selfRef">Configuration Availability</a>
        </h3>
<p id="section-8.2-1">An adversary that is able to obtain
every ECH configuration that is ever produced
can recover the anonymity set perfectly.
This design therefore depends on
adversaries being unable to
access all ECH configurations.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">Clients that use shared DNS caching resolvers
are less able to benefit from these protections.
Caching resolvers can improve privacy protections
by including the Client Subnet option <span>[<a href="#RFC7871" class="cite xref">RFC7871</a>]</span>
in DNS queries.
Authoritative resolvers are then able to
change the public name based on the Client Subnet prefix.
An adversary would then need to
present an IP address with the same prefix as a target
to learn the ECH configuration
that the target was presented with.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">A shorter TTL on resource records
increases the work required by an adversary.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">An authoritative DNS resolver that generates public names
based on the Client Subnet option
makes it easier for an adversary to enumerate
all the available public names
for a given hidden name.
The adversary can easily vary the Client Subnet option
that it includes in queries.
Whether the space is easily enumerable depends on
the minimum of
how many different public names might be generated
and how many Client Subnet values are in use.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="unique-mapping-to-hidden-names">
<section id="section-8.3">
        <h3 id="name-unique-mapping-to-hidden-na">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-unique-mapping-to-hidden-na" class="section-name selfRef">Unique Mapping To Hidden Names</a>
        </h3>
<p id="section-8.3-1">The use of a unique public name
could identify the hidden name.
If each hidden name corresponds to a different public name,
an adversary that is able to obtain that mapping
might reverse the mapping to recover the hidden name
from the unprotected "server_name" extension.
This attack is described in <a href="#unique-mapping" class="auto internal xref">Section 6.2</a>;
potential mitigations are described in <a href="#sample-pn-enc" class="auto internal xref">Section 7.3</a>.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">Providing a unique name mapping
in a retry configuration
carries no such risk;
see <a href="#retry-unique" class="auto internal xref">Section 7.3.3</a>.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-privacy">
<section id="section-8.4">
        <h3 id="name-client-privacy">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-client-privacy" class="section-name selfRef">Client Privacy</a>
        </h3>
<p id="section-8.4-1">The method in <a href="#unique-mapping" class="auto internal xref">Section 6.2</a> recommends
the inclusion of a client IP address
or the identity of its DNS recursive resolver
in the derivation of a public name.
This introduces a potential privacy leak.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">Any entity that can observe the TLS handshake
and is also able to obtain the same ECH configuration
might be able to learn something about the client IP address
or DNS resolver from the public name that is used.
The client-facing server also obtains the same information
with higher certainty.<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<p id="section-8.4-3">This risk is partly counteracted by
the limited number of bits that are retained
when generating public names in <a href="#sample-pn-enc" class="auto internal xref">Section 7.3</a>.
That increases the chances that different inputs
result in the same public name,
which might help if the adversary has no prior knowledge
of the client.
However, if an adversary only seeks to improve their confidence
in an existing hypothesis of client identity,
this is unlikely to be sufficient protection.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
<p id="section-8.4-4">A client that uses a tunnel,
such as a VPN or proxy,
for privacy purposes
can avoid leaking unwanted information
by accessing a DNS resolver using the tunnel.
This is also good practice
for the use of this sort of privacy mechanism
for reasons other than privacy,
such as ensuring that services are selected
for proximity to the tunnel egress point
rather than proximity to the client.<a href="#section-8.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document registers an extension
in the TLS "ECH Configuration Extension Registry"
established by <span>[<a href="#ECH" class="cite xref">ECH</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-9-2">
        <dt id="section-9-2.1">Value:</dt>
        <dd style="margin-left: 1.5em" id="section-9-2.2">
          <p id="section-9-2.2.1">0xTBD (value has to be 0x8000 or greater)<a href="#section-9-2.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-9-2.3">Extension Name:</dt>
        <dd style="margin-left: 1.5em" id="section-9-2.4">
          <p id="section-9-2.4.1">public_name_authn<a href="#section-9-2.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-9-2.5">Recommended:</dt>
        <dd style="margin-left: 1.5em" id="section-9-2.6">
          <p id="section-9-2.6.1">Y<a href="#section-9-2.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-9-2.7">Reference:</dt>
        <dd style="margin-left: 1.5em" id="section-9-2.8">
          <p id="section-9-2.8.1">This document<a href="#section-9-2.8.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-9-2.9">Notes:</dt>
        <dd style="margin-left: 1.5em" id="section-9-2.10">
          <p id="section-9-2.10.1">(none)<a href="#section-9-2.10.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="ECH">[ECH]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Oku, K.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"TLS Encrypted Client Hello"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-esni-23</span>, <time datetime="2025-02-19" class="refDate">19 February 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-23">https://datatracker.ietf.org/doc/html/draft-ietf-tls-esni-23</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AEAD">[AEAD]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refTitle">"An Interface and Algorithms for Authenticated Encryption"</span>, <span class="seriesInfo">RFC 5116</span>, <span class="seriesInfo">DOI 10.17487/RFC5116</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5116">https://www.rfc-editor.org/rfc/rfc5116</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IDNA">[IDNA]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names for Applications (IDNA): Definitions and Document Framework"</span>, <span class="seriesInfo">RFC 5890</span>, <span class="seriesInfo">DOI 10.17487/RFC5890</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5890">https://www.rfc-editor.org/rfc/rfc5890</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RAW">[RAW]</dt>
        <dd>
<span class="refAuthor">Wouters, P., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Gilmore, J.</span>, <span class="refAuthor">Weiler, S.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Using Raw Public Keys in Transport Layer Security (TLS) and Datagram Transport Layer Security (DTLS)"</span>, <span class="seriesInfo">RFC 7250</span>, <span class="seriesInfo">DOI 10.17487/RFC7250</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7250">https://www.rfc-editor.org/rfc/rfc7250</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7871">[RFC7871]</dt>
        <dd>
<span class="refAuthor">Contavalli, C.</span>, <span class="refAuthor">van der Gaast, W.</span>, <span class="refAuthor">Lawrence, D.</span>, and <span class="refAuthor">W. Kumari</span>, <span class="refTitle">"Client Subnet in DNS Queries"</span>, <span class="seriesInfo">RFC 7871</span>, <span class="seriesInfo">DOI 10.17487/RFC7871</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7871">https://www.rfc-editor.org/rfc/rfc7871</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9180">[RFC9180]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Bhargavan, K.</span>, <span class="refAuthor">Lipp, B.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Hybrid Public Key Encryption"</span>, <span class="seriesInfo">RFC 9180</span>, <span class="seriesInfo">DOI 10.17487/RFC9180</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9180">https://www.rfc-editor.org/rfc/rfc9180</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9460">[RFC9460]</dt>
        <dd>
<span class="refAuthor">Schwartz, B.</span>, <span class="refAuthor">Bishop, M.</span>, and <span class="refAuthor">E. Nygren</span>, <span class="refTitle">"Service Binding and Parameter Specification via the DNS (SVCB and HTTPS Resource Records)"</span>, <span class="seriesInfo">RFC 9460</span>, <span class="seriesInfo">DOI 10.17487/RFC9460</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9460">https://www.rfc-editor.org/rfc/rfc9460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SVCB">[SVCB]</dt>
        <dd>
<span class="refAuthor">Schwartz, B.</span>, <span class="refAuthor">Bishop, M.</span>, and <span class="refAuthor">E. Nygren</span>, <span class="refTitle">"Service Binding and Parameter Specification via the DNS (SVCB and HTTPS Resource Records)"</span>, <span class="seriesInfo">RFC 9460</span>, <span class="seriesInfo">DOI 10.17487/RFC9460</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9460">https://www.rfc-editor.org/rfc/rfc9460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WFP">[WFP]</dt>
      <dd>
<span class="refAuthor">Goldberg, I.</span>, <span class="refAuthor">Wang, T.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Network-Based Website Fingerprinting"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-pearg-website-fingerprinting-01</span>, <time datetime="2020-09-08" class="refDate">8 September 2020</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-pearg-website-fingerprinting-01">https://datatracker.ietf.org/doc/html/draft-irtf-pearg-website-fingerprinting-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">TODO<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Martin Thomson</span></div>
<div dir="auto" class="left"><span class="org">Mozilla</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mt@lowentropy.net" class="email">mt@lowentropy.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marwan Fayed</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marwan@cloudflare.com" class="email">marwan@cloudflare.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
